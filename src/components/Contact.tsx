"use client";

import React, { useRef } from "react";
import emailjs from "@emailjs/browser";
import { motion, useInView } from "framer-motion";
import { useFormStatus } from "react-dom";
import SubmitButton from "./ui/SubmitButton";

const varients = {
  initial: {
    opacity: 0,
    y: 500,
  },
  animate: {
    opacity: 1,
    y: 0,
    transition: {
      duration: 0.5,
      staggerChildren: 0.1,
    },
  },
};

const Contact = () => {
  const { pending } = useFormStatus();
  const form = useRef<HTMLFormElement>(null);
  const ref = useRef(null);
  const inView = useInView(ref, { margin: "-100px" });

  const sendEmail = () => {
    if (!form.current) return;
    emailjs
      .sendForm(
        "service_jfthy5f",
        "template_jn7xbx8",
        form.current,
        "uE4oObU-ushf6zRRS"
      )
      .then(
        () => {
          console.log("SUCCESS!");
        },
        (error) => {
          console.log("FAILED...", error.text);
        }
      );
  };

  return (
    <section className="section-container" id="contact">
      <motion.div
        ref={ref}
        variants={varients}
        initial="initial"
        whileInView="animate"
        className="w-full flex flex-col justify-center items-center gap-8"
      >
        <motion.div variants={varients} className="space-y-4">
          <h1 className="heading">Contact Me</h1>
          <h2 className="font-lora font-semibold text-xl md:text-2xl ">
            Feel free to reach out by sending an email.
          </h2>
        </motion.div>

        {/* form */}
        <motion.div
          variants={varients}
          className="relative  w-full flex justify-center"
        >
          <motion.div
            initial={{ opacity: 1 }}
            whileInView={{ opacity: 0 }}
            transition={{
              delay: 3,
              duration: 1,
            }}
            className=" absolute stroke-orange-400"
          >
            <svg width="300px" height="300px" viewBox="0 0 24 24" version="1.1">
              <motion.path
                initial={{ pathLength: 0 }}
                animate={inView && { pathLength: 1 }}
                transition={{ duration: 5 }}
                d="M6.85728,2.44483 C8.12042571,3.36621357 9.07582398,4.66114143 9.88931623,5.8489984 L10.5266,6.78724 L10.5266,6.78724 C10.9324,7.38031 10.8654,8.18484 10.3502,8.70006 L8.99378,10.0564 L9.13735723,10.3598745 C9.48709756,11.0688933 10.090754,12.09078 11,13 C11.6994,13.6994 12.4654667,14.218 13.1044815,14.5792963 L13.4710944,14.7773856 L13.4710944,14.7773856 L13.7979164,14.9388498 C13.8485542,14.9627711 13.8971467,14.9852133 13.9435,15.0062 L15.2993,13.6505 C15.8149,13.1348 16.6229,13.0668 17.2173,13.4787 L18.231355,14.1816565 C19.3829527,14.9918509 20.5856154,15.9152769 21.521,17.1132 C21.8626,17.5506 21.9133,18.1227 21.7096,18.5981 C20.8728,20.5506 18.7552,22.2135 16.5524,22.1324 L16.2518759,22.1157001 L16.2518759,22.1157001 L16.0189256,22.0956065 L16.0189256,22.0956065 L15.7611336,22.0667244 L15.7611336,22.0667244 L15.4795621,22.0276651 L15.4795621,22.0276651 L15.1752731,21.97704 L15.1752731,21.97704 L14.8493287,21.9134603 L14.8493287,21.9134603 L14.5027909,21.8355372 L14.5027909,21.8355372 L14.136722,21.7418821 L14.136722,21.7418821 L13.7521839,21.6311063 L13.7521839,21.6311063 L13.3502388,21.501821 C11.5039131,20.8763078 9.16110938,19.6463875 6.75735,17.2426 C4.35356813,14.8388125 3.12365344,12.4960155 2.49813876,10.6497099 L2.36885301,10.2477694 L2.36885301,10.2477694 L2.25807648,9.86323645 L2.25807648,9.86323645 L2.16442042,9.49717293 L2.16442042,9.49717293 L2.08649611,9.1506409 C2.06298899,9.03850349 2.04187237,8.92979832 2.02291481,8.82470242 L1.97228778,8.52041951 L1.97228778,8.52041951 L1.93322631,8.23885422 L1.93322631,8.23885422 L1.90434165,7.98106857 L1.90434165,7.98106857 L1.88424507,7.7481246 L1.88424507,7.7481246 L1.86754,7.44761 L1.86754,7.44761 C1.78675,5.25215 3.46855,3.11896 5.41215,2.28599 C5.86822,2.09053 6.4206,2.1263 6.85728,2.44483 Z M5.92868,4.25314 C4.85727,4.81363 3.81907,6.09364 3.86619,7.37406 L3.88690774,7.70247318 L3.88690774,7.70247318 L3.90752649,7.90675128 L3.90752649,7.90675128 L3.93698539,8.13627463 L3.93698539,8.13627463 L3.97678462,8.38994141 L3.97678462,8.38994141 L4.02842437,8.66664981 L4.02842437,8.66664981 L4.0934048,8.96529801 L4.0934048,8.96529801 L4.17322609,9.28478419 L4.17322609,9.28478419 L4.26938843,9.62400655 L4.26938843,9.62400655 L4.38339199,9.98186325 C4.4245334,10.1041321 4.46889837,10.2293231 4.51673694,10.3572525 L4.67092347,10.7490725 L4.67092347,10.7490725 L4.84745175,11.1562213 C5.47478248,12.5377081 6.4994787,14.156313 8.17157,15.8284 C9.84367,17.500487 11.4622861,18.5251826 12.8437764,19.1525157 L13.2509261,19.3290448 L13.2509261,19.3290448 L13.6427464,19.4832323 C13.7706758,19.5310712 13.8958667,19.5754366 14.0181354,19.6165784 L14.3759913,19.7305833 L14.3759913,19.7305833 L14.7152123,19.8267471 L14.7152123,19.8267471 L15.0346965,19.90657 L15.0346965,19.90657 L15.3333421,19.9715522 L15.3333421,19.9715522 L15.6100471,20.0231939 L15.6100471,20.0231939 L15.8637098,20.0629951 L15.8637098,20.0629951 L16.0932283,20.0924562 L16.0932283,20.0924562 L16.2975007,20.1130773 L16.2975007,20.1130773 L16.6259,20.1338 L16.6259,20.1338 C17.8904,20.1803 19.1802,19.1482 19.7377,18.0905 C19.02594,17.2553 18.14202,16.569988 17.1667848,15.879684 L16.4195,15.3586 L16.4195,15.3586 L16.2287129,15.5576071 L16.2287129,15.5576071 L15.8234859,16.0007156 L15.8234859,16.0007156 L15.6081259,16.2272519 C15.0218889,16.8240667 14.3384667,17.3314 13.5186,16.9998 L13.2922176,16.9049976 L13.2922176,16.9049976 L13.0163466,16.7812667 C12.9666028,16.7581762 12.915066,16.733837 12.8618707,16.7082272 L12.5238733,16.5391481 L12.5238733,16.5391481 L12.1525296,16.3385335 C11.3808004,15.9050735 10.4477343,15.2761429 9.58578,14.4142 C8.72384857,13.5522571 8.09490653,12.6191959 7.66143271,11.8474688 L7.46081111,11.4761259 L7.46081111,11.4761259 L7.29172529,11.1381291 L7.29172529,11.1381291 L7.09494623,10.7077823 L7.09494623,10.7077823 L7.00014,10.4814 L7.00014,10.4814 C6.68900875,9.71211875 7.11663531,9.06250937 7.66393766,8.50065293 L7.88777385,8.28051485 L7.88777385,8.28051485 L8.44543204,7.76814191 L8.44543204,7.76814191 L8.64461,7.57719 L8.64461,7.57719 L8.17202561,6.88477279 C7.4693238,5.86571388 6.78116,4.94448727 5.92868,4.25314 Z M14.9917005,6.03952315 L15.1077,6.05315 C15.8356,6.18149 16.5042,6.53699 17.0177,7.06867 C17.5311,7.60035 17.863,8.28093 17.9659,9.01287 C18.0428,9.55978 17.6617,10.0654 17.1148,10.1423 C16.6069643,10.2137071 16.1346531,9.89022337 16.0082806,9.40576032 L15.9854,9.29121 C15.9413,8.97753 15.799,8.68585 15.579,8.45799 C15.3955833,8.26809833 15.1660556,8.13065111 14.9140856,8.05827565 L14.7604,8.02276 C14.2166,7.92686 13.8534,7.4082 13.9493,6.86431 C14.03835,6.35926 14.4919571,6.01004352 14.9917005,6.03952315 L14.9917005,6.03952315 Z M15,2.99999 C15.7879,2.99999 16.5682,3.15518 17.2961,3.45671 C18.0241,3.75824 18.6855,4.2002 19.2427,4.75735 C19.7998,5.3145 20.2418,5.97594 20.5433,6.70389 C20.8448,7.43184 21,8.21206 21,8.99999 C21,9.55227 20.5523,9.99999 20,9.99999 C19.48715,9.99999 19.0644908,9.61394571 19.0067275,9.11661025 L19,8.99999 C19,8.4747 18.8966,7.95456 18.6955,7.46926 C18.4945,6.98395 18.1999,6.543 17.8284,6.17156 C17.457,5.80013 17.0161,5.50549 16.5307,5.30447 C16.1262833,5.13695333 15.6977,5.03718667 15.2620796,5.00858435 L15,4.99999 C14.4477,4.99999 14,4.55227 14,3.99999 C14,3.44771 14.4477,2.99999 15,2.99999 Z"
                id="形状"
                fill="none"
              ></motion.path>
            </svg>
          </motion.div>
          <motion.form
            initial={{ opacity: 0 }}
            whileInView={{ opacity: 1 }}
            transition={{
              delay: 4,
              duration: 1,
            }}
            ref={form}
            action={sendEmail}
            className=" w-full md:w-[60%] grid gap-4 "
          >
            <div className="flex flex-col gap-1 ">
              <input
                type="text"
                id="Name"
                name="name"
                disabled={pending}
                placeholder="Enter your  Name"
                className="input-style"
              />
            </div>

            <div className="flex flex-col gap-1 ">
              <input
                type="email"
                id="email"
                name="email"
                placeholder="Enter your email address"
                className="input-style"
              />
            </div>

            <div className="flex flex-col gap-1  ">
              <textarea
                id="text"
                name="message"
                placeholder="I value your opinion"
                className="input-style h-28 "
              />
            </div>
            {/* <button
              type="submit"
              className="px-6 py-2 rounded-lg shadow-md border-2 border-cyan-400  font-lora text-lg hover:scale-105 hover:shadow-lg transition-all ease-out duration-200 "
            >
              {pending ? "Submiting..." : "Submit"}
            </button> */}
            <SubmitButton />
          </motion.form>
        </motion.div>
        <motion.p
          variants={varients}
          className="text-base  font-lora font-medium"
        >
          Let&apos;s work together to bring your ideas to life. Reach out and
          let&apos;s build something amazing
        </motion.p>
      </motion.div>
    </section>
  );
};

export default Contact;
